import { type ReactNode, useEffect, useState } from 'react';
import { X } from 'lucide-react';
import clsx from 'clsx';

interface SideBarProps {
  children: ReactNode;
  brand: string;
  url: string;
}

export default function SideBar({ children, brand, url = '#' }: SideBarProps) {
  const [isMobile, setIsMobile] = useState(window.innerWidth <= 640);
  const [showSidebar, setShowSidebar] = useState(false);
  const handleClick = () => {
    setShowSidebar(!showSidebar);
  };

  const CloseButton = (
    <X className="text-brown-700 cursor-pointer" size={24} onClick={handleClick} />
  );

  const handleWindowSizeChange = () => {
    setIsMobile(window.innerWidth <= 640);
  };

  useEffect(() => {
    window.addEventListener('resize', handleWindowSizeChange);
    window.addEventListener('app:sidebar:open', () => {
      setShowSidebar(true);
    });

    return () => {
      window.removeEventListener('resize', handleWindowSizeChange);
      window.removeEventListener('app:sidebar:open', () => {
        setShowSidebar(true);
      });
    };
  }, []);

  return (
    <>
      <aside
        id="sidebar"
        className={clsx({
          'h-full ease-in-out duration-300': true,
          'w-3/12': !isMobile,
          'w-64 top-0 -left-64 fixed z-40': isMobile,
          'translate-x-full': isMobile && showSidebar,
          'translate-x-0': isMobile && !showSidebar,
        })}
        aria-label="SideBar"
      >
        <div className="flex h-full flex-col overflow-y-auto border-r border-slate-200 bg-white px-4 pb-4 dark:border-slate-700 dark:bg-slate-900">
          <div className="mb-4 flex items-center justify-between rounded-lg py-2 text-slate-900 dark:text-white">
            <a
              href={url}
              className="flex items-center rounded-lg py-2 text-slate-900 dark:text-white"
            >
              <svg
                className="h-10 w-10"
                width="40"
                height="38"
                viewBox="0 0 40 38"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M32.3801 20.3346C32.3801 27.1746 26.8386 32.7149 19.9998 32.7149C13.1621 32.7149 7.61951 27.1746 7.61951 20.3346C7.61951 13.4969 13.1633 7.95312 19.9998 7.95312C26.8386 7.95428 32.3801 13.4969 32.3801 20.3346Z"
                  fill="#6D6E71"
                />
                <path
                  d="M29.2665 35.6106H10.7331C8.8045 35.6106 7.86161 34.0596 7.53265 32.9349L4.44684 32.87C4.26961 32.8665 4.10281 32.7808 3.99625 32.6384C3.88968 32.497 3.85377 32.3129 3.9001 32.1403L4.58816 29.5734L1.75486 28.8193C1.5788 28.7718 1.43516 28.6456 1.36682 28.4765C1.29848 28.3073 1.31354 28.1162 1.40736 27.961L2.79621 25.6524L0.298836 24.2717C0.137827 24.1825 0.0289433 24.0215 0.00461826 23.8385C-0.0185485 23.6566 0.0463184 23.4736 0.179527 23.345L2.18229 21.4372L0.179527 19.5306C0.0463184 19.4032 -0.0185485 19.2202 0.00461826 19.0372C0.0289433 18.8542 0.137827 18.6931 0.298836 18.604L2.79621 17.2209L1.40621 14.9112C1.31238 14.7548 1.29732 14.5637 1.36566 14.3957C1.43401 14.2266 1.57764 14.1003 1.75371 14.0528L4.587 13.2999L3.89895 10.7307C3.85261 10.5593 3.88852 10.3751 3.99509 10.2327C4.10165 10.0902 4.26846 10.0056 4.44684 10.001L7.42955 9.9396L7.49674 7.27311C7.50137 7.10052 7.58246 6.93835 7.71914 6.83178C7.85582 6.72521 8.03305 6.68467 8.20101 6.7229L11.1212 7.37272L11.9517 4.785C12.0038 4.62399 12.1231 4.49426 12.2784 4.42823C12.4359 4.36337 12.612 4.36916 12.7614 4.44445L15.407 5.76379L16.9604 3.4367C17.053 3.29885 17.2013 3.20619 17.3658 3.18418C17.5337 3.16217 17.6982 3.21198 17.8222 3.32202L19.9998 5.21358L22.1775 3.31855C22.3038 3.20966 22.4682 3.15985 22.635 3.18186C22.8007 3.20387 22.9466 3.29654 23.0405 3.43438L24.5926 5.76148L27.2406 4.44213C27.3912 4.36684 27.5684 4.36221 27.7236 4.42592C27.88 4.49194 27.9981 4.62168 28.0503 4.78268L28.8796 7.37041L31.7998 6.72058C31.9689 6.68351 32.145 6.7229 32.2817 6.82946C32.4184 6.93603 32.4994 7.0982 32.5041 7.27079L32.5713 9.93728L35.5528 9.99867C35.73 10.0021 35.8968 10.0879 36.0034 10.2303C36.1111 10.3728 36.1459 10.557 36.0995 10.7284L35.4103 13.2965L38.2471 14.0494C38.4232 14.0957 38.5668 14.2231 38.6363 14.3922C38.7046 14.5614 38.6896 14.7525 38.5958 14.9077L37.2046 17.2174L39.7008 18.6005C39.863 18.6897 39.9707 18.8507 39.995 19.0337C40.0194 19.2167 39.9533 19.3997 39.8201 19.5271L37.8174 21.4338L39.8201 23.3415C39.9533 23.469 40.0194 23.6531 39.995 23.835C39.9707 24.018 39.863 24.179 39.7008 24.2682L37.2058 25.649L38.5958 27.9575C38.6896 28.1139 38.7046 28.305 38.6363 28.473C38.5668 28.6421 38.4232 28.7684 38.2483 28.8158L35.4103 29.5699L36.0995 32.1368C36.1459 32.3082 36.1111 32.4924 36.0046 32.6349C35.8968 32.7774 35.7312 32.8631 35.5528 32.8665L32.4682 32.9314C32.138 34.0596 31.1951 35.6106 29.2665 35.6106Z"
                  fill="#662113"
                />
                <path
                  d="M17.9009 30.1944C17.8755 30.1944 17.85 30.1933 17.8245 30.1898C17.6589 30.1678 17.5117 30.0751 17.4191 29.9361L16.1936 28.1002L14.1028 29.1415C13.951 29.2157 13.775 29.2226 13.6186 29.1577C13.4634 29.0917 13.344 28.962 13.2919 28.7998L12.6386 26.7646L10.3335 27.2766C10.1621 27.3125 9.98719 27.2731 9.85051 27.1666C9.71382 27.06 9.63274 26.899 9.62811 26.7252L9.57598 24.6356L7.22572 24.5858C7.04849 24.5823 6.88169 24.4966 6.77512 24.3541C6.66856 24.2128 6.63265 24.0286 6.67898 23.856L7.21645 21.8498L4.99244 21.259C4.81638 21.2115 4.67274 21.0853 4.6044 20.9162C4.53606 20.7471 4.55112 20.5559 4.64494 20.4007L5.7303 18.5972L3.77503 17.5153C3.61286 17.4261 3.50398 17.2651 3.48081 17.0821C3.45765 16.8991 3.52251 16.716 3.65572 16.5886L5.22179 15.0955L3.65572 13.6048C3.52251 13.4773 3.45765 13.2943 3.48081 13.1113C3.50514 12.9283 3.61402 12.7673 3.77503 12.6781L5.73146 11.595L4.6461 9.79035C4.55228 9.63397 4.53722 9.44285 4.60556 9.27489C4.6739 9.10577 4.81753 8.97952 4.9936 8.93202L7.21992 8.34011L6.68014 6.33387C6.63381 6.16244 6.66972 5.97826 6.77628 5.83579C6.88285 5.69331 7.04965 5.60876 7.22803 5.60412L9.5783 5.55547L9.63042 3.46467C9.63506 3.29208 9.71614 3.12992 9.85282 3.02335C9.98835 2.91678 10.1656 2.87624 10.3347 2.91446L12.6398 3.42645L13.2931 1.39241C13.3452 1.2314 13.4645 1.10167 13.6197 1.03564C13.7773 0.971934 13.9522 0.976568 14.1039 1.05186L16.1947 2.0932L17.4202 0.258399C17.5129 0.120557 17.66 0.0278901 17.8257 0.00588172C17.9925 -0.0184433 18.1581 0.0336817 18.2832 0.143724L19.9999 1.63914L21.7188 0.143724C21.8451 0.0336817 22.0119 -0.0161267 22.1764 0.00588172C22.342 0.0278901 22.488 0.120557 22.5818 0.258399L23.8061 2.09205L25.8993 1.04954C26.0498 0.975409 26.2271 0.969618 26.3823 1.03448C26.5387 1.10051 26.6568 1.23024 26.7089 1.39125L27.3599 3.42529L29.6662 2.91331C29.8353 2.87508 30.0137 2.91562 30.148 3.02219C30.2847 3.12876 30.3658 3.29092 30.3704 3.46467L30.4226 5.55431L32.7717 5.60296C32.9489 5.60644 33.1157 5.69216 33.2223 5.83463C33.33 5.97711 33.3647 6.16128 33.3184 6.33272L32.7798 8.34127L35.0084 8.93318C35.1845 8.98067 35.3281 9.10693 35.3976 9.27605C35.466 9.44517 35.4509 9.63629 35.3571 9.79151L34.2706 11.5962L36.227 12.6792C36.3892 12.7684 36.4969 12.9294 36.5212 13.1125C36.5455 13.2955 36.4795 13.4785 36.3463 13.6059L34.7791 15.0967L36.3463 16.5898C36.4795 16.7172 36.5455 16.9002 36.5212 17.0832C36.4969 17.2663 36.388 17.4261 36.227 17.5165L34.2717 18.5983L35.3582 20.4019C35.4521 20.5582 35.4671 20.7494 35.3988 20.9173C35.3293 21.0853 35.1856 21.2127 35.0107 21.2602L32.7809 21.8533L33.3196 23.8595C33.3659 24.0309 33.3311 24.2151 33.2246 24.3576C33.1169 24.5001 32.9512 24.5858 32.7728 24.5893L30.4237 24.6391L30.3716 26.7287C30.367 26.9013 30.2859 27.0635 30.1492 27.17C30.0137 27.2766 29.8353 27.316 29.6673 27.2801L27.3611 26.7681L26.7101 28.8033C26.658 28.9643 26.5398 29.0952 26.3834 29.1612C26.2282 29.2284 26.0545 29.2226 25.9004 29.145L23.8085 28.1037L22.5829 29.9396C22.4903 30.0786 22.3432 30.1701 22.1775 30.1933C22.013 30.2141 21.8462 30.1655 21.72 30.0554L19.9999 28.5531L18.282 30.052C18.1755 30.1446 18.0399 30.1944 17.9009 30.1944Z"
                  fill="#8A4B38"
                />
                <path
                  d="M14.7873 28.1418H25.2123C29.2908 28.1418 32.7415 31.1246 32.7415 33.3544C32.7415 35.2656 31.1778 35.671 29.2665 35.671H10.7331C8.82187 35.671 7.25812 35.2656 7.25812 33.3544C7.25812 31.1246 10.7215 28.1418 14.7873 28.1418Z"
                  fill="#8A4B38"
                />
                <path
                  d="M29.5236 23.1923C29.5236 27.9276 25.261 31.7617 19.9998 31.7617C14.7386 31.7617 10.476 27.9276 10.476 23.1923C10.476 18.4582 14.7386 14.6206 19.9998 14.6206C25.261 14.6206 29.5236 18.4582 29.5236 23.1923Z"
                  fill="#D99E82"
                />
                <path
                  d="M23.8096 27.478C23.8096 29.8445 22.1034 31.7627 19.9998 31.7627C17.8963 31.7627 16.1901 29.8445 16.1901 27.478C16.1901 25.1116 17.8951 23.1934 19.9998 23.1934C22.1045 23.1934 23.8096 25.1104 23.8096 27.478Z"
                  fill="#E6E7E8"
                />
                <path
                  d="M23.6403 22.6209C23.8168 21.6533 24.6994 20.2019 26.2879 22.6209"
                  stroke="#8A4B38"
                  strokeWidth="0.8"
                  strokeLinecap="round"
                />
                <path
                  d="M13.7117 22.621C13.8882 21.6534 14.7708 20.202 16.3594 22.621"
                  stroke="#8A4B38"
                  strokeWidth="0.8"
                  strokeLinecap="round"
                />
                <path
                  d="M12.3803 17.4784C12.3803 17.4784 17.1422 15.5741 18.0944 17.4784C19.0477 19.3827 19.9998 19.3827 19.9998 19.3827V13.6675C19.9998 13.6686 12.3803 13.6686 12.3803 17.4784ZM27.6182 17.4784C27.6182 17.4784 22.8575 15.5741 21.9042 17.4784C20.952 19.3827 19.9998 19.3827 19.9998 19.3827V13.6675C19.9998 13.6686 27.6182 13.6686 27.6182 17.4784Z"
                  fill="#C1694F"
                />
                <path
                  d="M13.3335 17.9531C13.3335 19.269 12.2678 20.3347 10.9531 20.3347C9.63726 20.3347 8.57159 19.269 8.57159 17.9531C8.57159 16.6384 9.63726 15.5728 10.9531 15.5728C12.2678 15.5728 13.3335 16.6384 13.3335 17.9531ZM31.4279 17.9531C31.4279 19.269 30.3622 20.3347 29.0463 20.3347C27.7316 20.3347 26.6648 19.269 26.6648 17.9531C26.6648 16.6384 27.7316 15.5728 29.0463 15.5728C30.3622 15.5728 31.4279 16.6384 31.4279 17.9531ZM11.8914 37.3483C9.57471 37.3483 9.57471 32.715 14.2081 32.715C18.8414 32.715 18.9132 37.3483 16.5247 37.3483H11.8914ZM23.4748 37.3483C21.1581 37.3483 21.1581 32.715 25.7914 32.715C30.4248 32.715 30.4966 37.3483 28.1081 37.3483H23.4748Z"
                  fill="#D99E82"
                />
                <circle cx="19.9997" cy="28.9089" r="1.65477" fill="#8A4B38" />
              </svg>
              <span className="ml-2 font-nunito font-black text-brown-700 uppercase text-xl">
                {brand}
              </span>
            </a>
            {isMobile && CloseButton}
          </div>
          {children}
        </div>
      </aside>
    </>
  );
}
